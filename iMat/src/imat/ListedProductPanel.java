/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package imat;

import se.chalmers.ait.dat215.project.*;

/**
 *
 * @author filip
 */
public class ListedProductPanel extends javax.swing.JPanel implements java.beans.Customizer {
    
    private Object bean;
    private ShoppingItem item;
    private IMatDataHandler dataHandler = IMatDataHandler.getInstance();

    /**
     * Creates new customizer ProductPanel
     */
    public ListedProductPanel() {
        initComponents();
    }
    
    public ListedProductPanel(ShoppingItem item) {
        this();
        this.item = item;
        this.titleLabel.setText(item.getProduct().getName());
        this.priceLabel.setText(Double.toString(item.getProduct().getPrice()) + " " + item.getProduct().getUnit());
        this.adjustedPriceLabel.setText(Double.toString(item.getTotal()) + " kr");
        this.amountSpinner.setValue(item.getAmount());
        this.unitLabel.setText(item.getProduct().getUnitSuffix());
    }
    
    public void setObject(Object bean) {
        this.bean = bean;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the FormEditor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        titleLabel = new javax.swing.JLabel();
        priceLabel = new javax.swing.JLabel();
        amountPanel = new javax.swing.JPanel();
        filler2 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(25, 0), new java.awt.Dimension(50, 0));
        amountSpinner = new javax.swing.JSpinner();
        filler1 = new javax.swing.Box.Filler(new java.awt.Dimension(10, 0), new java.awt.Dimension(25, 0), new java.awt.Dimension(50, 0));
        unitLabel = new javax.swing.JLabel();
        adjustedPriceLabel = new javax.swing.JLabel();
        RemoveFromCartButton = new javax.swing.JButton();

        setBackground(new java.awt.Color(255, 255, 255));
        setBorder(javax.swing.BorderFactory.createCompoundBorder(javax.swing.BorderFactory.createMatteBorder(0, 0, 1, 0, new java.awt.Color(200, 200, 200)), javax.swing.BorderFactory.createEmptyBorder(20, 20, 20, 20)));
        setDoubleBuffered(false);
        setMaximumSize(new java.awt.Dimension(500, 80));
        setMinimumSize(new java.awt.Dimension(500, 80));
        setPreferredSize(new java.awt.Dimension(500, 80));
        setLayout(new java.awt.GridLayout(1, 5));

        titleLabel.setText("Titel");
        titleLabel.setMaximumSize(null);
        titleLabel.setMinimumSize(null);
        titleLabel.setPreferredSize(null);
        add(titleLabel);

        priceLabel.setForeground(new java.awt.Color(255, 0, 0));
        priceLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        priceLabel.setText("Pris");
        priceLabel.setToolTipText("");
        priceLabel.setMaximumSize(null);
        priceLabel.setMinimumSize(null);
        priceLabel.setPreferredSize(null);
        add(priceLabel);

        amountPanel.setBackground(new java.awt.Color(255, 255, 255));
        amountPanel.setMaximumSize(null);
        amountPanel.setMinimumSize(null);
        amountPanel.setPreferredSize(null);
        amountPanel.setLayout(new javax.swing.BoxLayout(amountPanel, javax.swing.BoxLayout.LINE_AXIS));
        amountPanel.add(filler2);

        amountSpinner.setMaximumSize(new java.awt.Dimension(30, 20));
        amountSpinner.setMinimumSize(null);
        amountSpinner.setPreferredSize(new java.awt.Dimension(30, 20));
        amountSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                amountSpinnerStateChanged(evt);
            }
        });
        amountPanel.add(amountSpinner);
        amountPanel.add(filler1);

        unitLabel.setText("jLabel1");
        unitLabel.setMaximumSize(null);
        unitLabel.setMinimumSize(null);
        unitLabel.setPreferredSize(null);
        amountPanel.add(unitLabel);

        add(amountPanel);

        adjustedPriceLabel.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        adjustedPriceLabel.setText("10");
        adjustedPriceLabel.setMaximumSize(null);
        adjustedPriceLabel.setMinimumSize(null);
        adjustedPriceLabel.setPreferredSize(null);
        add(adjustedPriceLabel);

        RemoveFromCartButton.setFont(new java.awt.Font("Helvetica", 1, 18)); // NOI18N
        RemoveFromCartButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imat/resources/button.png"))); // NOI18N
        RemoveFromCartButton.setText("â•³");
        RemoveFromCartButton.setBorderPainted(false);
        RemoveFromCartButton.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        RemoveFromCartButton.setHorizontalTextPosition(javax.swing.SwingConstants.CENTER);
        RemoveFromCartButton.setIconTextGap(0);
        RemoveFromCartButton.setMargin(new java.awt.Insets(14, 14, 14, 14));
        RemoveFromCartButton.setPreferredSize(new java.awt.Dimension(76, 40));
        RemoveFromCartButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                RemoveFromCartButtonActionPerformed(evt);
            }
        });
        add(RemoveFromCartButton);
    }// </editor-fold>//GEN-END:initComponents

    private void amountSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_amountSpinnerStateChanged
        if((double)amountSpinner.getValue() < 1)
            amountSpinner.setValue(1);
        
        item.setAmount((double)amountSpinner.getValue());
        this.adjustedPriceLabel.setText(item.getTotal() + " kr");
    }//GEN-LAST:event_amountSpinnerStateChanged

    private void RemoveFromCartButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_RemoveFromCartButtonActionPerformed
        dataHandler.getShoppingCart().removeItem(item);
        
    }//GEN-LAST:event_RemoveFromCartButtonActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton RemoveFromCartButton;
    private javax.swing.JLabel adjustedPriceLabel;
    private javax.swing.JPanel amountPanel;
    private javax.swing.JSpinner amountSpinner;
    private javax.swing.Box.Filler filler1;
    private javax.swing.Box.Filler filler2;
    private javax.swing.JLabel priceLabel;
    private javax.swing.JLabel titleLabel;
    private javax.swing.JLabel unitLabel;
    // End of variables declaration//GEN-END:variables
}
