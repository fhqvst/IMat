/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package imat;

import javax.swing.JPanel;
import se.chalmers.ait.dat215.project.*;

/**
 *
 * @author filip
 */
public class ListedProductPanel extends javax.swing.JPanel implements java.beans.Customizer {
    
    private Object bean;
    private ShoppingItem item;
    private IMatDataHandler dataHandler = IMatDataHandler.getInstance();

    /**
     * Creates new customizer ProductPanel
     */
    public ListedProductPanel() {
        initComponents();
    }
    
    public ListedProductPanel(ShoppingItem item) {
        this();
        this.item = item;
        this.titleLabel.setText(item.getProduct().getName());
        this.priceLabel.setText(Double.toString(item.getProduct().getPrice()) + " " + item.getProduct().getUnit());
        this.adjustedPriceLabel.setText(Double.toString(item.getTotal()) + " kr");
        this.amountSpinner.setValue(item.getAmount());
    }
    
    public void setObject(Object bean) {
        this.bean = bean;
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the FormEditor.
     */
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        titleLabel = new javax.swing.JLabel();
        priceLabel = new javax.swing.JLabel();
        amountSpinner = new javax.swing.JSpinner();
        adjustedPriceLabel = new javax.swing.JLabel();
        RemoveFromCartButton = new javax.swing.JButton();

        setBackground(new java.awt.Color(255, 255, 255));
        setBorder(javax.swing.BorderFactory.createEmptyBorder(10, 10, 10, 10));
        setMaximumSize(new java.awt.Dimension(2147483647, 70));
        setMinimumSize(new java.awt.Dimension(0, 35));
        setPreferredSize(new java.awt.Dimension(600, 70));
        setLayout(new java.awt.GridLayout(1, 0, 20, 20));

        titleLabel.setText("Titel");
        titleLabel.setMaximumSize(new java.awt.Dimension(2147483647, 40));
        titleLabel.setMinimumSize(new java.awt.Dimension(0, 0));
        titleLabel.setPreferredSize(null);
        add(titleLabel);

        priceLabel.setForeground(new java.awt.Color(255, 0, 0));
        priceLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        priceLabel.setText("Pris");
        priceLabel.setToolTipText("");
        add(priceLabel);

        amountSpinner.setMaximumSize(new java.awt.Dimension(2147483647, 40));
        amountSpinner.setMinimumSize(new java.awt.Dimension(0, 0));
        amountSpinner.setPreferredSize(new java.awt.Dimension(70, 40));
        amountSpinner.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                amountSpinnerStateChanged(evt);
            }
        });
        add(amountSpinner);

        adjustedPriceLabel.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        adjustedPriceLabel.setText("10");
        add(adjustedPriceLabel);

        RemoveFromCartButton.setFont(new java.awt.Font("Tahoma", 1, 11)); // NOI18N
        RemoveFromCartButton.setText("X");
        RemoveFromCartButton.setCursor(new java.awt.Cursor(java.awt.Cursor.HAND_CURSOR));
        RemoveFromCartButton.setMaximumSize(new java.awt.Dimension(2147483647, 40));
        RemoveFromCartButton.setMinimumSize(new java.awt.Dimension(0, 0));
        RemoveFromCartButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                RemoveFromCartButtonActionPerformed(evt);
            }
        });
        add(RemoveFromCartButton);
    }// </editor-fold>//GEN-END:initComponents

    private void amountSpinnerStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_amountSpinnerStateChanged
        if((double)amountSpinner.getValue() < 1)
            amountSpinner.setValue(1);
        
        item.setAmount((double)amountSpinner.getValue());
        this.adjustedPriceLabel.setText(item.getTotal() + " kr");
    }//GEN-LAST:event_amountSpinnerStateChanged

    private void RemoveFromCartButtonActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_RemoveFromCartButtonActionPerformed
        dataHandler.getShoppingCart().removeItem(item);
    }//GEN-LAST:event_RemoveFromCartButtonActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton RemoveFromCartButton;
    private javax.swing.JLabel adjustedPriceLabel;
    private javax.swing.JSpinner amountSpinner;
    private javax.swing.JLabel priceLabel;
    private javax.swing.JLabel titleLabel;
    // End of variables declaration//GEN-END:variables
}
